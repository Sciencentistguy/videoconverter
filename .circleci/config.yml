# Use the latest 2.1 version of CircleCI pipeline process engine.
# See: https://circleci.com/docs/2.0/configuration-reference
version: 2.1

orbs:
  rust: circleci/rust@1.6.0

workflows:
  rustup:
    jobs:
      - rust/lint-test-build:
          release: true
          version: "1.61.0"

jobs:
  nix-build:
    docker:
      - image: "nixos/nix"
    steps:
      - run: nix-channel --update
      - run: nix-env -f '<nixpkgs>' -iA git
      - checkout
      - run: nix --extra-experimental-features 'flakes nix-command' build .
